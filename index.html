<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Grupo Lider Madeiras</title>
    <link rel="icon" type="image/jpeg" href="./img/lider-logo.jpeg">
    <link rel="stylesheet" href="css/styles.css">
    <!-- Three.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <div id="hyperspeed-canvas"></div>
            <canvas id="lightning-canvas"></canvas>
            <canvas id="fluid-canvas"></canvas>
            <h1>
                <img src="./img/lider-logo.jpeg" alt="L√≠der Madeiras" style="height: 50px; vertical-align: middle; margin-right: 12px; border-radius: 8px;">
                Sistema Grupo L√≠der Madeiras
            </h1>

        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab(0)">üìã Fornecedores/Clientes</button>
            <button class="tab" onclick="showTab(1)">üí∞ Pre√ßos</button>
            <button class="tab" onclick="showTab(2)">üìç Dist. Clientes</button>
            <button class="tab" onclick="showTab(3)">üéØ Simula√ß√£o</button>
            <button class="tab" onclick="showTab(4)">üèÜ Resultados</button>
        </div>

        <div class="content">
            <!-- ABA 1: FORNECEDORES/CLIENTES -->
            <div class="tab-content active">
                <div class="section">
                    <h3>Aba 1: CADASTRO FORNECEDORES/CLIENTES</h3>
                    <p style="margin-bottom: 12px; font-size: 13px;">Clique nas c√©lulas para editar</p>

                    <div class="alert success">
                        <strong>‚úèÔ∏è Campos Edit√°veis:</strong> Clique para editar. Altera√ß√µes s√£o salvas automaticamente!
                    </div>

                    <table id="tableFornecedores">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nome Fornecedor/Cliente</th>
                                <th>Estado</th>
                                <th>Cidade</th>
                                <th>Email</th>
                                <th>KM</th>
                            </tr>
                        </thead>
                        <tbody id="fornecedoresBody">
                        </tbody>
                    </table>

                    <button class="btn btn-add" onclick="adicionarFornecedor()">‚ûï Adicionar Fornecedor/Cliente</button>
                </div>
            </div>

            <!-- ABA 2: PRE√áOS -->
            <div class="tab-content">
                <div class="section">
                    <h3>Aba 2: PRE√áOS MADEIRA</h3>
                    <p style="margin-bottom: 12px; font-size: 13px;">Edite pre√ßos dos produtos</p>

                    <div class="alert success">
                        <strong>‚úèÔ∏è Campos Edit√°veis:</strong> Clique para editar pre√ßos!
                    </div>

                    <table id="tablePrecos">
                        <thead>
                            <tr>
                                <th>ID Forn./Cliente</th>
                                <th>Espes.</th>
                                <th>Larg.</th>
                                <th>Compr.</th>
                                <th>Tipo</th>
                                <th>Pre√ßo</th>
                            </tr>
                        </thead>
                        <tbody id="precosBody">
                        </tbody>
                    </table>

                    <button class="btn btn-add" onclick="adicionarPreco()">‚ûï Adicionar Pre√ßo</button>
                </div>
            </div>

            <!-- ABA 3: DIST√ÇNCIAS -->
            <div class="tab-content">
                <div class="section">
                    <h3>Aba 3: DIST√ÇNCIAS PARA CLIENTES (KM)</h3>
                    <p style="margin-bottom: 12px; font-size: 13px;">Dist√¢ncias entre fornecedores e clientes</p>

                    <div class="alert" style="margin-bottom: 15px;">
                        <strong>üí° Dica:</strong> Adicione, remova ou edite cidades clientes no cadastro de cada Fornecedor/Cliente (clique no nome na Aba 1)
                    </div>

                    <div class="alert success">
                        <strong>‚úèÔ∏è Campos Edit√°veis:</strong> Atualize as dist√¢ncias!
                    </div>

                    <table id="tableDistancias">
                        <thead>
                            <tr>
                                <th>Origem</th>
                                <th>C. Grande</th>
                                <th>S. Paulo</th>
                                <th>Curitiba</th>
                                <th>Alegre</th>
                                <th>B. Horiz.</th>
                            </tr>
                        </thead>
                        <tbody id="distanciasBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ABA 4: SIMULA√á√ÉO -->
            <div class="tab-content">
                <div class="section">
                    <h3>Aba 4: SIMULA√á√ÉO VENDA</h3>
                    <p style="margin-bottom: 12px; font-size: 13px;">Configure os dados da venda</p>

                    <div class="example-box">
                        <h4 style="margin-bottom: 12px; color: #667eea; font-size: 14px;">‚öôÔ∏è Dados da Venda</h4>

                        <div class="form-grid">
                            <div class="form-group">
                                <label>Cidade Destino (Cliente)</label>
                                <select id="cidadeDestino">
                                    <option>Campo Grande/MS</option>
                                    <option>S√£o Paulo/SP</option>
                                    <option>Curitiba/PR</option>
                                    <option>Porto Alegre/RS</option>
                                    <option>Belo Horizonte/MG</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>M¬≥ Total</label>
                                <input type="number" id="m3Total" value="50" min="1" step="0.1">
                            </div>

                            <div class="form-group">
                                <label>Valor de Venda (R$/m¬≥)</label>
                                <input type="number" id="valorVenda" value="1230" min="0" step="0.01">
                            </div>

                            <div class="form-group">
                                <label>Tipo de Madeira</label>
                                <select id="tipoMadeira">
                                    <option value="verde">Verde (1000 kg/m¬≥)</option>
                                    <option value="seca">Seca (500 kg/m¬≥)</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="example-box" style="margin-top: 12px;">
                        <h4 style="margin-bottom: 12px; color: #667eea; font-size: 14px;">üì¶ Composi√ß√£o da Carga</h4>

                        <div class="produto-row" style="font-weight: 600; color: #667eea; margin-bottom: 10px;">
                            <div>Produto</div>
                            <div>Esp.</div>
                            <div>Larg.</div>
                            <div>%</div>
                            <div>M¬≥</div>
                        </div>

                        <div class="produto-row">
                            <input type="text" value="T√°bua 2x30cm" readonly style="background: #f8f9fa;">
                            <input type="number" class="espessura" value="2.0" step="0.1">
                            <input type="number" class="largura" value="30" step="1">
                            <input type="number" class="percentual" value="50" min="0" max="100" step="1">
                            <input type="text" class="m3produto" readonly style="background: #e7f3ff;">
                        </div>

                        <div class="produto-row">
                            <input type="text" value="T√°bua 2x25cm" readonly style="background: #f8f9fa;">
                            <input type="number" class="espessura" value="2.0" step="0.1">
                            <input type="number" class="largura" value="25" step="1">
                            <input type="number" class="percentual" value="20" min="0" max="100" step="1">
                            <input type="text" class="m3produto" readonly style="background: #e7f3ff;">
                        </div>

                        <div class="produto-row">
                            <input type="text" value="T√°bua 2x20cm" readonly style="background: #f8f9fa;">
                            <input type="number" class="espessura" value="2.0" step="0.1">
                            <input type="number" class="largura" value="20" step="1">
                            <input type="number" class="percentual" value="30" min="0" max="100" step="1">
                            <input type="text" class="m3produto" readonly style="background: #e7f3ff;">
                        </div>
                    </div>

                    <div class="alert">
                        <strong>‚úÖ Total dos Percentuais:</strong> <span id="totalPercentual" style="font-weight: 700;">100</span>%
                    </div>

                    <button class="btn" onclick="calcularFornecedores()">üîç Analisar Fornecedores/Clientes</button>
                </div>
            </div>

            <!-- ABA 5: RESULTADOS -->
            <div class="tab-content">
                <div class="section">
                    <h3>Aba 5: RESULTADOS COMPARA√á√ÉO</h3>
                    <p style="margin-bottom: 12px; font-size: 13px;">An√°lise de todos os fornecedores/clientes</p>

                    <div class="instruction">
                        <h4>üîç C√°lculos Autom√°ticos:</h4>
                        <ul>
                            <li><strong>Custo Madeira:</strong> <span class="formula">=SOMA(Pre√ßo*M¬≥)</span></li>
                            <li><strong>Peso Total:</strong> <span class="formula">=M¬≥*Peso_Madeira</span></li>
                            <li><strong>Valor Frete:</strong> <span class="formula">=Dist√¢ncia*Pre√ßo_KM</span></li>
                            <li><strong>Custo Total:</strong> <span class="formula">=Madeira+Frete</span></li>
                            <li><strong>Margem Lucro:</strong> <span class="formula">=(Venda-Custo)/Custo*100</span></li>
                        </ul>
                    </div>

                    <div class="results-container" id="resultsContainer"></div>

                    <div id="noResults" class="alert">
                        <strong>üìä Aguardando c√°lculo...</strong> Configure a simula√ß√£o e clique em "Analisar Fornecedores/Clientes".
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Modal Fornecedor/Cliente -->
    <div class="modal-overlay" id="modalFornecedor">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitulo">üìã Fornecedor/Cliente</h2>
                <button class="modal-close" onclick="fecharModal()">√ó</button>
            </div>
            <div class="modal-body">
                <!-- Dados Cadastrais -->
                <div class="modal-section">
                    <h3>üìä Dados Cadastrais</h3>
                    <div class="alert success" style="margin-bottom: 12px;">
                        <strong>‚úèÔ∏è Campos Edit√°veis:</strong> Clique nos campos para editar Nome, Estado, Cidade, Email e KM Base!
                    </div>
                    <div class="data-grid" id="modalDadosCadastrais">
                    </div>

                    <!-- Dist√¢ncias para Clientes -->
                    <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; flex-wrap: wrap; gap: 10px;">
                            <h4 style="color: #667eea; font-size: 15px; margin: 0;">üìç Dist√¢ncias para Clientes</h4>
                            <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                <button class="btn-add-cidade" onclick="event.stopPropagation(); adicionarCidadeCliente();" title="Adicionar nova cidade de destino">‚ûï Adicionar</button>
                                <button class="btn-calcular-api" onclick="event.stopPropagation(); calcularDistanciasAPI();" title="Calcular todas as dist√¢ncias automaticamente">üîÑ Calcular</button>
                            </div>
                        </div>
                        <div class="alert success" style="margin-bottom: 12px; font-size: 12px;" id="alertAPIStatus">
                            <strong>‚úÖ OSRM Ativo - 100% Gratuito!</strong>
                            <br>‚Ä¢ Dist√¢ncias calculadas automaticamente por rotas reais
                            <br>‚Ä¢ Sem necessidade de API Key
                            <br>‚Ä¢ Use "‚ûï Adicionar" para novas cidades
                            <br>‚Ä¢ Use "üîÑ Calcular" para recalcular todas
                        </div>
                        <div class="distancias-grid" id="modalDistanciasCadastrais">
                            <p style="color: #6c757d; text-align: center; grid-column: 1/-1; padding: 20px;">Clique em "‚ûï Adicionar" para come√ßar.</p>
                        </div>
                    </div>
                </div>

                <!-- Pre√ßos Madeira Verde -->
                <div class="modal-section">
                    <h3>üå≤ Pre√ßos - Madeira Verde</h3>
                    <table class="precos-table">
                        <thead>
                            <tr>
                                <th>Espes.</th>
                                <th>Larg.</th>
                                <th>Compr.</th>
                                <th>R$/m¬≥</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="modalPrecosVerde">
                        </tbody>
                    </table>
                    <button class="btn-add-produto" onclick="adicionarProdutoModal('Verde')">‚ûï Adicionar Verde</button>
                </div>

                <!-- Pre√ßos Madeira Seca -->
                <div class="modal-section">
                    <h3>ü™µ Pre√ßos - Madeira Seca</h3>
                    <table class="precos-table">
                        <thead>
                            <tr>
                                <th>Espes.</th>
                                <th>Larg.</th>
                                <th>Compr.</th>
                                <th>R$/m¬≥</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="modalPrecosSeca">
                        </tbody>
                    </table>
                    <button class="btn-add-produto" onclick="adicionarProdutoModal('Seca')">‚ûï Adicionar Seco</button>
                </div>

                <!-- Caminh√µes -->
                <div class="modal-section">
                    <h3>üöõ Caminh√µes</h3>
                    <table class="precos-table">
                        <thead>
                            <tr>
                                <th>Tipo</th>
                                <th>Capac. (t)</th>
                                <th>Pre√ßo/KM</th>
                                <th>Pre√ßo P/ Tonelada</th>
                                <th>KM do Cliente</th>
                                <th>Frete Total</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="modalCaminhoes">
                        </tbody>
                    </table>
                    <button class="btn-add-produto" onclick="adicionarCaminhaoModal()">‚ûï Adicionar Caminh√£o</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Adicionar Cidade -->
    <div class="modal-overlay" id="modalAdicionarCidade" style="z-index: 10001;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2>‚ûï Adicionar Cidade Cliente</h2>
                <button class="modal-close" onclick="event.stopPropagation(); fecharModalCidade();">√ó</button>
            </div>
            <div class="modal-body">
                <div class="alert" style="margin-bottom: 20px; font-size: 13px; background: #e7f3ff; border-left-color: #0066cc;">
                    <strong>üí° Formato Correto:</strong> Digite o nome da cidade seguido do estado<br>
                    <strong>‚úì Exemplos corretos:</strong><br>
                    ‚Ä¢ "Rio de Janeiro/RJ"<br>
                    ‚Ä¢ "Bras√≠lia/DF"<br>
                    ‚Ä¢ "Manaus/AM"<br>
                    ‚Ä¢ "Porto Alegre/RS"
                </div>

                <div class="form-group">
                    <label style="font-size: 14px; font-weight: 600; color: #495057; margin-bottom: 8px; display: block;">
                        üåç Nome da Cidade
                    </label>
                    <input
                        type="text"
                        id="inputNovaCidade"
                        placeholder="Ex: Rio de Janeiro/RJ"
                        style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px; transition: all 0.3s;"
                        onkeypress="if(event.key === 'Enter') { event.preventDefault(); confirmarAdicionarCidade(); }"
                    >
                </div>

                <div class="form-group" style="margin-top: 20px;">
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 13px;">
                        <input type="checkbox" id="checkCalcularAuto" checked style="width: 18px; height: 18px; cursor: pointer;">
                        <span style="color: #495057;">üîÑ Calcular dist√¢ncia automaticamente</span>
                    </label>
                </div>

                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button class="btn" onclick="confirmarAdicionarCidade()" style="flex: 1;">‚úì Confirmar</button>
                    <button class="btn" onclick="fecharModalCidade()" style="flex: 1; background: linear-gradient(135deg, #6c757d 0%, #495057 100%);">‚úï Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts JavaScript -->
    <script src="js/hyperspeed-effect.js"></script>
    <script src="js/lightning-effect.js"></script>
    <script src="js/fluid-interactive.js"></script>
    <script src="js/config.js"></script>
    <script src="js/data.js"></script>
    <script src="js/api.js"></script>
    <script src="js/calculations.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/tabs.js"></script>
    <script src="js/modal.js"></script>
    <script src="js/main.js"></script>
    <script>
        // Initialize all three effects on header
        document.addEventListener('DOMContentLoaded', function() {
            // Hyperspeed road effect (bottom layer)
            initHyperspeedEffect('hyperspeed-canvas', {
                roadWidth: 9,
                islandWidth: 2,
                length: 400,
                fov: 90,
                speedFactor: 1,
                colors: {
                    roadColor: 0x080808,
                    islandColor: 0x0a0a0a,
                    leftCars: [0xff6ec7, 0x7b2cbf, 0xc77dff],
                    rightCars: [0x00d9ff, 0x4361ee, 0x4cc9f0],
                    sticks: 0x00d9ff
                }
            });

            // Lightning effect (middle layer)
            initLightningEffect('lightning-canvas', {
                hue: 230,        // Cor em graus (0-360): 230 = azul
                xOffset: 0,      // Deslocamento horizontal
                speed: 1,        // Velocidade da anima√ß√£o
                intensity: 0.6,  // Intensidade do brilho (reduzida)
                size: 1          // Tamanho/escala do efeito
            });

            // Fluid interactive effect (top layer)
            initFluidInteractive('fluid-canvas', {
                SIM_RESOLUTION: 128,
                DYE_RESOLUTION: 1024,
                DENSITY_DISSIPATION: 0.98,
                VELOCITY_DISSIPATION: 0.99,
                PRESSURE: 0.8,
                PRESSURE_ITERATIONS: 20,
                CURL: 30,
                SPLAT_RADIUS: 0.25,
                SPLAT_FORCE: 6000,
                COLOR_UPDATE_SPEED: 10,
                TRANSPARENT: true
            });
        });
    </script>
</body>
</html>
